<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./style.css" />
    <title>Contact Us - OtakuChiefIntern</title>
  </head>
  <body>
    <nav class="main-nav">
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="about.html">About Me</a></li>
        <li><a href="contact.html" class="active">Contact Us</a></li>
      </ul>
    </nav>

    <main class="contact-page">
      <header class="page-header">
        <h1>Contact Us</h1>
        <p>Get in touch with us! We'd love to hear from you.</p>
      </header>

      <form class="contact-form" novalidate>
        <div class="form-group">
          <label for="full-name" class="form-label">Full Name *</label>
          <input
            type="text"
            id="full-name"
            name="fullName"
            class="form-input"
            data-testid="test-contact-name"
            required
            aria-describedby="full-name-error"
          />
          <div id="full-name-error" class="error-message" data-testid="test-contact-error-name" role="alert" aria-live="polite"></div>
        </div>

        <div class="form-group">
          <label for="email" class="form-label">Email *</label>
          <input
            type="email"
            id="email"
            name="email"
            class="form-input"
            data-testid="test-contact-email"
            required
            aria-describedby="email-error"
          />
          <div id="email-error" class="error-message" data-testid="test-contact-error-email" role="alert" aria-live="polite"></div>
        </div>

        <div class="form-group">
          <label for="subject" class="form-label">Subject *</label>
          <input
            type="text"
            id="subject"
            name="subject"
            class="form-input"
            data-testid="test-contact-subject"
            required
            aria-describedby="subject-error"
          />
          <div id="subject-error" class="error-message" data-testid="test-contact-error-subject" role="alert" aria-live="polite"></div>
        </div>

        <div class="form-group">
          <label for="message" class="form-label">Message *</label>
          <textarea
            id="message"
            name="message"
            class="form-textarea"
            rows="5"
            data-testid="test-contact-message"
            required
            aria-describedby="message-error"
            minlength="10"
          ></textarea>
          <div id="message-error" class="error-message" data-testid="test-contact-error-message" role="alert" aria-live="polite"></div>
        </div>

        <button type="submit" class="submit-btn" data-testid="test-contact-submit">
          Send Message
        </button>

        <div class="success-message" data-testid="test-contact-success" role="alert" aria-live="polite" style="display: none;">
          Thank you for your message! We'll get back to you soon.
        </div>
      </form>
    </main>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const form = document.querySelector('.contact-form');
        const successMessage = document.querySelector('[data-testid="test-contact-success"]');
        
        console.log('Form found:', form);
        console.log('Success message found:', successMessage);
        
        function validateField(field) {
          const value = field.value.trim();
          const fieldName = field.name;
          const fieldId = field.id;
          const errorElement = document.getElementById(`${fieldId}-error`);
          let isValid = true;
          let errorMessage = '';

          console.log('Validating field:', fieldId, 'Error element:', errorElement);

          if (errorElement) {
            errorElement.textContent = '';
          }
          field.classList.remove('error');

          if (!value) {
            errorMessage = `${fieldName === 'fullName' ? 'Full name' : fieldName.charAt(0).toUpperCase() + fieldName.slice(1)} is required.`;
            isValid = false;
          }
          else if (fieldName === 'email' && value) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(value)) {
              errorMessage = 'Please enter a valid email address.';
              isValid = false;
            }
          }
          else if (fieldName === 'message' && value.length < 10) {
            errorMessage = 'Message must be at least 10 characters long.';
            isValid = false;
          }

          if (!isValid) {
            if (errorElement) {
              errorElement.textContent = errorMessage;
            }
            field.classList.add('error');
            field.setAttribute('aria-invalid', 'true');
          } else {
            field.setAttribute('aria-invalid', 'false');
          }

          return isValid;
        }

        const inputs = form.querySelectorAll('input, textarea');
        const submitButton = form.querySelector('[data-testid="test-contact-submit"]');
        
        console.log('Submit button found:', submitButton);
        
        submitButton.addEventListener('click', function(e) {
          console.log('Submit button clicked!');
        });
        
        inputs.forEach(input => {
          input.addEventListener('blur', () => validateField(input));
          input.addEventListener('input', () => {
            if (input.classList.contains('error')) {
              validateField(input);
            }
          });
        });

        form.addEventListener('submit', function(e) {
          console.log('Form submit event triggered!');
          e.preventDefault();
          
          successMessage.style.display = 'none';
          
          let isFormValid = true;
          inputs.forEach(input => {
            if (!validateField(input)) {
              isFormValid = false;
            }
          });

          if (isFormValid) {
            successMessage.style.display = 'block';
            successMessage.scrollIntoView({ behavior: 'smooth' });
            
            setTimeout(() => {
              form.reset();
              inputs.forEach(input => {
                input.classList.remove('error');
                input.setAttribute('aria-invalid', 'false');
              });
            }, 1000);
          } else {
            const firstError = form.querySelector('.error');
            if (firstError) {
              firstError.focus();
            }
          }
        });
      });
    </script>
  </body>
</html>
